<!DOCTYPE html>
<html>
<head>
    <title>Critical System Alert</title>
    <style>
        /* Styles for the programmer/system look */
        body { background-color: #0d1117; color: #c9d1d9; font-family: 'Courier New', monospace; text-align: center; padding-top: 50px; }
        #initial-message, #proposal-form { margin: 30px; }
        .role { color: #a371f7; font-weight: bold; }
        #reveal-button, button[type="submit"] { 
            background-color: #238636; /* GitHub Green */
            color: white; border: none; padding: 10px 20px; font-size: 18px; 
            cursor: pointer; border-radius: 6px; margin: 5px; 
        }
        #proposal-form { display: none; } 
        .response-button:hover { opacity: 0.9; }
        #success-message { color: #238636; margin-top: 20px; font-weight: bold; }
    </style>
</head>
<body>

    <div id="initial-message">
        <h1>SYSTEM ERROR: REQUIRED ASSETS MISSING</h1>
        <p>Dependency Bman and Jenica's-Wedding/core/entourage.js failed to load.</p>
        <p><strong>You</strong> are the only one who can patch this.</p>
        <button id="reveal-button" onclick="startPatch()">RUN DEBUGGER</button>
    </div>
    
    <form id="proposal-form" action="https://formspree.io/f/mpwybyar" method="POST">
        <h1 id="greeting"></h1>
        <p>Will you be my <span class="role"></span> on **January 12, 2026**?</p>
        <p>Please confirm your acceptance below:</p>

        <input type="hidden" name="name" id="hidden-name-field" value="">
        <input type="hidden" name="date" value="January 12">
        <input type="hidden" name="_subject" id="subject-field" value="Groomsman Proposal Accepted!">

        <button type="submit" name="response" value="Yes" class="response-button">Yes</button>
        <button type="submit" name="response" value="Of Course" class="response-button">Of Course</button>

        <p id="success-message" style="display: none;">**Transmission Confirmed.** Details will follow. Thank you! :)</p>
    </form>

   <script>
    // ----------------------------------------------------------------------
    // --- 1. CONFIGURATION (UPDATE THESE LISTS) ---
    // ----------------------------------------------------------------------
    
    // **YOUR AUTHORIZED NAME-ROLE PAIRS**
    // Key: The exact name (case-sensitive) as it appears in the URL
    // Value: The required role code (e.g., 'bm' or 'gm')
    const AUTHORIZED_PAIRS = {
        "Bestest": "bm",      // John MUST have role=bm
        "Bespren": "bm",      // Mike MUST have role=gm
        "Jhondel": "gm",      // Alex MUST have role=gm
        "Jes": "gm",
        "Paeng": "gm",       // Sam MUST have role=us (Usher)
        "Jason": "gm",
        "Ken": "gm",
        "Louie": "gm",
        "Liam": "gm",
        "Je": "gm",
        "Vincent": "gm"
        // Add your remaining groomsmen here!
    }; 
    
    // Role Code Dictionary (Translates code for display/email)
    const ROLE_DICTIONARY = {
        'gm': 'Groomsman',
        'bm': 'Best Man',
        'us': 'Usher',
    };
    
    // ----------------------------------------------------------------------
    // --- 2. URL PARAMETER AND VALIDATION LOGIC ---
    // ----------------------------------------------------------------------

    const urlParams = new URLSearchParams(window.location.search);
    const FRIEND_NAME = urlParams.get('name');
    const FRIEND_ROLE_CODE = urlParams.get('role'); 

    // Find the correct role code based on the name (the one we *expect* to see)
    const EXPECTED_ROLE_CODE = AUTHORIZED_PAIRS[FRIEND_NAME];
    
    // Translate the code for display/email
    const FRIEND_ROLE = ROLE_DICTIONARY[FRIEND_ROLE_CODE] || 'Groomsman';
    
    // Check if the URL name and role code are valid together
    // The link is authorized if:
    // 1. The name exists in our list AND
    // 2. The role code in the URL matches the expected role code for that name.
    const isAuthorized = FRIEND_ROLE_CODE === EXPECTED_ROLE_CODE;


    // Initial check when the page loads
    window.onload = function() {
        const debuggerButton = document.getElementById('reveal-button');
        const initialMessage = document.getElementById('initial-message');

        if (!isAuthorized) {
            // If the name-role pair is NOT authorized, lock down the page
            debuggerButton.disabled = true;
            debuggerButton.style.backgroundColor = '#992222';
            debuggerButton.innerHTML = 'ACCESS DENIED';
            
            // Update the error message
            initialMessage.querySelector('p').innerHTML = 
                '**ERROR 403:** Authorization token is invalid or corrupted. Access to core assets is denied. Contact system admin.';
        }
    };
    
    // ----------------------------------------------------------------------
    // --- 3. CORE FUNCTIONALITY ---
    // ----------------------------------------------------------------------

    function startPatch() {
        // This function will only run if the button is enabled
        
        // 1. Hide initial message and show the form
        document.getElementById('initial-message').style.display = 'none';
        document.getElementById('proposal-form').style.display = 'block';

        // 2. Personalize the elements
        const greeting = document.getElementById('greeting');
        const roleSpan = document.querySelector('#proposal-form .role');
        const hiddenNameField = document.getElementById('hidden-name-field');
        const subjectField = document.getElementById('subject-field');

        greeting.innerHTML = `Hi, <span class="role">${FRIEND_NAME}</span>!`;
        roleSpan.innerHTML = FRIEND_ROLE;
        hiddenNameField.value = FRIEND_NAME;
        
        subjectField.value = `${FRIEND_ROLE} Proposal Accepted by ${FRIEND_NAME}`;
    }
    
    // This handles the form submission to Formspree
    document.getElementById('proposal-form').addEventListener("submit", async function (event) {
        event.preventDefault();
        const form = event.target;
        const data = new FormData(form);
        
        await fetch(form.action, {
            method: form.method,
            body: data,
            headers: { 'Accept': 'application/json' }
        });

        document.getElementById('proposal-form').querySelector('p:last-child').style.display = 'none';
        document.getElementById('proposal-form').querySelectorAll('.response-button').forEach(btn => btn.style.display = 'none');
        document.getElementById('success-message').style.display = 'block';
    });
</script>

</body>
</html>






